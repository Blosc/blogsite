<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Zstd has just landed in Blosc | Blosc Main Blog Page </title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="http://blosc.org/posts/zstd-has-just-landed-in-blosc/">
<link rel="icon" href="../../blosc-favicon_16x16.png" sizes="16x16">
<link rel="icon" href="../../blosc-favicon_32x32.png" sizes="32x32">
<link rel="icon" href="../../blosc-favicon_64x64.png" sizes="64x64">
<link rel="icon" href="../../blosc-favicon_128x128.png" sizes="128x128">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-111342564-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111342564-2');
</script><meta name="author" content="Francesc Alted">
<link rel="prev" href="../arm-is-becoming-a-first-class-citizen-for-blosc/" title="ARM is becoming a first-class citizen for Blosc" type="text/html">
<link rel="next" href="../blosclz-tuning/" title="Fine Tuning the BloscLZ codec" type="text/html">
<meta property="og:site_name" content="Blosc Main Blog Page ">
<meta property="og:title" content="Zstd has just landed in Blosc">
<meta property="og:url" content="http://blosc.org/posts/zstd-has-just-landed-in-blosc/">
<meta property="og:description" content="Zstd has just landed in Blosc
Zstd, aka Zstandard, is a new breed of compression
library that promises to achieve better compression ratios than Zlib, and at better speeds too. The fact that Zstd is g">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-07-20T11:32:20Z">
<meta property="article:tag" content="Zstandard">
<meta property="article:tag" content="Zstd">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://blosc.org/">
                <img src="../../blosc-logo_128.png" alt="Blosc Main Blog Page " id="logo"></a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../pages/blosc-in-depth/">Blosc In Depth</a>
                </li>
<li>
<a href="../../pages/synthetic-benchmarks/">Benchmarks</a>
                </li>
<li>
<a href="../../pages/donate/">Donate to Blosc</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.rst" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Zstd has just landed in Blosc</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/francesc-alted/">Francesc Alted</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2016-07-20T11:32:20Z" itemprop="datePublished" title="2016-07-20 11:32">2016-07-20 11:32</time></a>
            </p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/zstd-has-just-landed-in-blosc.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.rst" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div class="section" id="zstd-has-just-landed-in-blosc">
<h2>Zstd has just landed in Blosc</h2>
<p><a class="reference external" href="http://www.zstd.net">Zstd</a>, aka Zstandard, is a new breed of compression
library that promises to achieve better compression ratios than <a class="reference external" href="http://www.zlib.net/">Zlib</a>, and at better speeds too. The fact that Zstd is geared
towards fast compression / decompression since the beginning was an indication
for me that it could be a good fit for Blosc. After some months of
experimentation with Zstd in <a class="reference external" href="https://github.com/Blosc/c-blosc2/pull/6">Blosc2</a>, I am really happy to say that I am
quite impressed on how the pair performs.</p>
<p>And now that the Zstd format has been declared <a class="reference external" href="http://fastcompression.blogspot.com.es/2016_07_03_archive.html">stable</a> and that its
API is maturing rapidly, it is a good time for inclusion in the <a class="reference external" href="https://github.com/Blosc/c-blosc/pull/171">Blosc1</a> project too. In Blosc1 there was
still a couple of slots available for additional codecs, and after my positive
experiences with Zstd I decided that it would be an excellent candidate to take
one of the free seats (will see which one will take the last one, if any).</p>
<p>Beware: the Zstd support in Blosc should still be considered in <strong>beta</strong>
and so it is not recommended to use this new codec in production yet. It is
indeed recommended to start experimenting with it so as to see the kind of
improvements that it can bring to your scenario, and specially report possible
flaws back.</p>
<div class="section" id="a-compression-beast-for-blosc-operation">
<h3>A compression beast for Blosc operation</h3>
<p>As said, Zstd is meant to achieve better compression ratios than Zlib, and this
is indeed the <a class="reference external" href="http://www.zstd.net">case for many situations already</a>. But it
turns out that Zstd shines specially when faced to the kind of data that is left
after the shuffle (or bitshuffle) filter passes.</p>
<p>As for one, here it is the typical benchmark plot for compressing with Zstd on
my machine (Intel Xeon E3-1245-v5 @ 3.5GHz), side-by-side with Zlib which was
the codec having the best compression ratios among all the supported inside
Blosc:</p>
<table>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody><tr>
<td><p><img alt="lap-zstd-c" src="../../images/zstd-E3-1245-v5-4p-compr.png"></p></td>
<td><p><img alt="lap-zlib-c" src="../../images/zlib-E3-1245-v5-compr.png"></p></td>
</tr></tbody>
</table>
<p>As can be seen, Zstd achieves a maximum compression ratio of more than 300x for
this specific dataset, which is quite a lot more than the 70x achieved by Zlib.
But the coolest thing is that we are not paying a performance price for this
increased compression ratio, rather the contrary, because Zstd is clearly
superior (up to a 25%) in compression speed to Zlib.</p>
<p>But one of the most distinctive features for Blosc is its ability to decompress
data very fast (sometimes faster than memcpy() as I like to remind). And look at
what Zstd is able to achieve in this case:</p>
<table>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody><tr>
<td><p><img alt="lap-zstd-d" src="../../images/zstd-E3-1245-v5-4p.png"></p></td>
<td><p><img alt="lap-zlib-d" src="../../images/zlib-E3-1245-v5.png"></p></td>
</tr></tbody>
</table>
<p>With peak speeds larger than 10 GB/s, Zstd can decompress data more than 2x
faster than Zlib peaks (~ 4 GB/s). And more importantly, when it comes to
decompress data at the highest compression level, Zstd can do that about 6x
faster than Zlib (~6 GB/s vs ~1 GB/s), which is a welcome surprise.</p>
</div>
<div class="section" id="not-the-fastest-but-a-nicely-balanced-one">
<h3>Not the fastest, but a nicely balanced one</h3>
<p>Of course, Zstd is still far from the fastest codecs in Blosc. See for example
how the internal BloscLZ codec can perform in this machine:</p>
<table>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody><tr>
<td><p><img alt="lap-blosclz-c" src="../../images/blosclz-E3-1245-v5-compr.png"></p></td>
<td><p><img alt="lap-blosclz-d" src="../../images/blosclz-E3-1245-v5.png"></p></td>
</tr></tbody>
</table>
<p>But nevertheless, due to its impressive balance between compression ratio and
speed, Zstd is called to be one of the most attractive codecs in Blosc for the
near future.</p>
<p>As always, all these benchmarks here were made for the specific, synthetic
dataset that I am using for Blosc since the beginning (mainly for
reproducibility purposes). But I am pretty sure that most of the capabilities
shown here will be experienced in a large variety of datasets that Blosc is
meant to tackle (in fact, it would be nice if you can share your experience by
adding a comment below).</p>
<p>Finally, my special thanks to Yann Collet, the author of Zstd (as well as <a class="reference external" href="http://www.lz4.org/">LZ4</a>, also included in Blosc) for putting his genius at the
service of the community by opening not only his code, but also his mind in his
amazing series of blogs about compression: <a class="reference external" href="http://fastcompression.blogspot.com">http://fastcompression.blogspot.com</a></p>
</div>
<div class="section" id="appendix-what-can-be-expected-in-blosc2">
<h3>Appendix: What can be expected in Blosc2</h3>
<p>Blosc2 has support for Zstd contexts and
a new way to split chunks into blocks that makes codecs go faster in general.
Below you have a couple of plots on how the Blosc2/Zstd couple behaves:</p>
<table>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody><tr>
<td><p><img alt="blosc2-zstd-c" src="../../images/zstd-E3-1245-v5-compr-blosc2.png"></p></td>
<td><p><img alt="blosc2-zstd-d" src="../../images/zstd-E3-1245-v5-blosc2.png"></p></td>
</tr></tbody>
</table>
<p>As can be seen, in Blosc2 Zstd can get peaks of more than 15 GB/s, almost reaching
memcpy() speed in this machine (~17 GB/s).  Also, decompression speed at the
highest compression ratio can scale when throwing more threads at it (a thing
that Blosc1 is not able to achieve), and easily surpasses 10 GB/s.  Notice
that reaching such a high speed while decompressing a buffer with a really high
compression ratio (~300x) is really impressing.  On his part, compression speed
is a bit less (25%) than in Blosc1 but still quite competitive (and on par with Zlib).</p>
<p>This is really exciting news to be added on top of the new planned features for Blosc2.</p>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/zstandard/" rel="tag">Zstandard</a></li>
            <li><a class="tag p-category" href="../../categories/zstd/" rel="tag">Zstd</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../arm-is-becoming-a-first-class-citizen-for-blosc/" rel="prev" title="ARM is becoming a first-class citizen for Blosc">Previous post</a>
            </li>
            <li class="next">
                <a href="../blosclz-tuning/" rel="next" title="Fine Tuning the BloscLZ codec">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="blosc",
            disqus_url="http://blosc.org/posts/zstd-has-just-landed-in-blosc/",
        disqus_title="Zstd has just landed in Blosc",
        disqus_identifier="cache/posts/zstd-has-just-landed-in-blosc.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="blosc";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2021         <a href="mailto:blosc@blosc.org">The Blosc Developers</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
